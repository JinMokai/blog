---
title: "Astro"
pubDate: "2021-8-2"
updateDate: ""
description: "Astroè€è¯­æ³•ï¼Œå·²ç»æ²¡æœ‰å€¼å¾—å‚è€ƒä»·å€¼ï¼Œæ€€æ—§å³å¯ï¼"
author: "ch_kai"
image:
    url: "/assets/content/astro/info_logo.png"
    alt: "Astroæ¡†æ¶logoå›¾ç‰‡"
tags: ["Astro"]
draft: false
---

# AstroèƒŒæ™¯ä»‹ç»ğŸš€

+ Astroæ˜¯ä¸€ä¸ªå»ºç«™çš„Javascript Web æ¡†æ¶ã€‚ç±»ä¼¼jekyllä½†æ˜¯åˆä¸åŒâœ‹
+ Astroå®˜ç½‘[^1]
+ Astroæ–‡æ¡£[^2]
+ Githubåœ°å€[^3]

> ç”±äºastroæœ€æ–°æ¡†æ¶å‡ºç°çš„æ¯”è¾ƒæ—©ï¼Œå¯èƒ½ä¼šå‡ºç°å¾ˆå¤šæœªçŸ¥é—®é¢˜æˆ‘ä»¬åº”è¯¥å¤šå»githubåœ°å€Issuesæé—®ğŸ›

# å¼€å§‹åˆ¶ä½œ

## ç‰ˆæœ¬
+ **astro 0.18.5**

```shell
npm init astro
npm install 
npm start
# ä½¿ç”¨ä¸Šè¿°å‘½ä»¤å®‰è£…astro
```
# ç›®å½•ç»“æ„
```
â”‚  astro.config.mjs
â”‚  package-lock.json
â”‚  package.json
â”‚  README.md
â”‚
â”œâ”€public
â”‚  â”‚  favicon.svg
â”‚  â”‚  robots.txt
â”‚  â”‚
â”‚  â”œâ”€assets
â”‚  â”‚      logo.svg
â”‚  â”‚
â”‚  â””â”€style
â”‚          code.scss
â”‚          global.css
â”‚          home.css
â”‚
â””â”€src
    â”œâ”€components
    â”‚      Head.astro
    â”‚      Header.astro
    â”‚
    â”œâ”€layout
    â”‚      MainDown.astro
    â”‚      MainPreview.astro
    â”‚
    â””â”€pages
        â”‚  index.astro
        â”‚
        â””â”€posts
                æµ‹è¯•01.md
                æµ‹è¯•02.md
```
> public æ˜¯å…¬å…±éƒ¨åˆ†ï¼Œpublic/styleé‡Œé¢æ˜¯æ ·å¼ï¼Œscræ˜¯æ ¹ç›®å½•ã€‚src/components æ˜¯ç»„ä»¶ï¼Œsrc/layoutæ˜¯é¡µé¢å¸ƒå±€æ–‡ä»¶ï¼Œsrc/pages æ˜¯é¡µé¢æ–‡ä»¶ã€‚


# æ­¥éª¤

+ src/pages/index.astro

```html
---
import Head from '../components/Head.astro'
import MainPreview from '../layout/MainPreview.astro'
import Header from '../components/Header.astro'

let title = 'My Astro Site';

// è·å–æ–‡æ¡£ ä½¿ç”¨
 let resMark = await Astro.fetchContent('./posts/*.md')
 resMark = resMark.sort((a,b) => new Date(b.time) - new Date(a.time))
---
<html lang="en">
<head>
    <Head title={title}></Head>
</head>
<style lang="scss">
    .box {
        max-width: 1020px;
        margin: 0 auto;
    }
</style>
<body>
<div class="box">
    <Header />
    <hr>
    {
        resMark.map((p) => <MainPreview post={p} />)
    }
</div>
</body>
</html>

```

> await Astro.fetchContent('./posts/*.md'); æ˜¯Astro APIè¯­æ³•ï¼Œåå»posts/ä¸‹é¢çš„mdæ–‡æ¡£æ•°æ®ï¼

+ src/layout/MainPreview.astro

```html
---
// åšå®¢é¢„è§ˆç®€ä»‹
export interface Props {
   post: any
}
const { post } = Astro.props

---

<div>
<ul>
    <li>
        <a href={post.url}>{post.title}</a>
        <p>{post.author}</p>
        <p>{post.time}</p>
    </li>
</ul>
</div>
```

> console.log(post)æ‰“å°çš„ç»“æœ

<img class="lazy" data-src="/assets/content/astro/json.png">

+ src/components/Head.astro
    - Head.astroæ˜¯è®¾ç½®ä¸»é¡µindex.astroé‡Œé¢<head>æ ‡ç­¾é‡Œé¢æ•°æ®æ•…æ­¤ç”¨ç»„ä»¶æ¥ä»£æ›¿ã€‚

```html
---
const  { title,code } = Astro.props
---
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{title}</title>
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    {code && <link rel="stylesheet" href="/style/code.css" />}
```

+ componentsç»„ä»¶é‡Œé¢æ‰“å°çš„ç»“æœ
<pre>

Astroç»“æœ
{
  site: URL {
    href: 'http://localhost:3000/',
    origin: 'http://localhost:3000',
    protocol: 'http:',
    username: '',
    password: '',
    host: 'localhost:3000',
    hostname: 'localhost',
    port: '3000',
    pathname: '/',
    search: '',
    searchParams: URLSearchParams {},
    hash: ''
  },
  fetchContent: [Function: fetchContent],
  props: { title: 'My Astro Site' },
  css: [],
  request: {},
  isPage: false
}

</pre>


+ src/components/Header.astro
    - è¿™ä¸ªæ˜¯è®¾ç½®å¤´éƒ¨ç»“æ„,æ‰“å°çš„Astroä¸ä¸Šé¢Astroç»“æœä¸€è‡´ï¼

```html
---
const {site} = Astro
---
    <a href={site.href}>åšå®¢</a>
```

+ src/pages/*.md
    - *.md æ–‡æ¡£é€šè¿‡Astroè¯­æ³•Apiæ¥æ¥å—æ•°æ®é€šè¿‡Array.prototype.sort()æ¥è®¾ç½®æ•°ç»„é¡ºåºï¼

<img class="lazy" data-src="/assets/content/astro/blog.png">


+ src/pages/posts/æµ‹è¯•1.md
    -  markdownè¯­æ³•

```markdown
---
title: 'ç¬¬ä¸€ä¸ªåšå®¢'
author: 'jinkai'
time: '2021-8-1'
layout: '../../layout/MainDown.astro'
code: true
// code ä¸ºæ˜¯å¦å¼€å¯codeæ ‡ç­¾ã€‚(ä¸‹æ–‡ä¼šç»“åˆmarkdownçš„æ’ä»¶æ ·å¼æ¥ç»“åˆä½¿ç”¨)
---

# ç¬¬ä¸€ä¸ªmdåšå®¢

+ çœ‹åˆ°æ²¡æœ‰ç¬¬ä¸€ä¸ªåšå®¢

```javascript
let a = 1
function fn() {
    console.log(a)
    retrun
}
```


+ src/layout/MainDown.astro
    - MainDown.astroæ˜¯ä½œä¸ºmdæ–‡æ¡£ä¸Šé¢æ‰€ç”¨çš„å¸ƒå±€


```html
---
import Head from '../components/Head.astro'
import Header from '../components/Header.astro'
const { content } = Astro.props
const { code,title } = content
---
  <head>
    <Head code={code} title={title}></Head>
  </head>
  <style lang="scss">
    .container {
      width: 1020px;
      margin: 0 auto;
    }
  </style>
<body>
<div class="container">
<Header />
    <main>
        <!-- slotæ ‡ç­¾æ˜¯å†…åµŒmarkdownæ–‡æ¡£æ’å…¥çš„å¿…è¦æ¡ä»¶ -->
        <slot />
    </main>
</div>
</body>

```

+ å›¾ç‰‡

<img alt="mark" data-src="/assets/content/astro/mark.png">


# è¡¥å……

## Astro || å’Œ && è¯­æ³•è¡¥å……
```
---
 let a = true
 let b = false
---

{a || '#a'} <br />
{b || '#b'} <br />
{a && 'aa'} <br />
{b && 'bb'} <br />
     
|| ç¬¦å·  å¦‚æœå‰è€…å‚æ•°ä¸ºfalse å°±ä¼šæ˜¾ç¤ºåè€…æ•°æ®,å‰è€…ä¸ºtrueæ˜¾ç¤ºå‰è€…
&& ç¬¦å·  å¦‚æœå‰è€…å‚æ•°ä¸ºtrue  å°±ä¼šæ˜¾ç¤ºåè€…æ•°æ®,å‰è€…ä¸ºfalseå°±éšè—
```

> å‰æ–‡è¯´{code && <link rel="stylesheet" href="/style/code.css" />}åˆ¤æ–­æ˜¯å¦åˆcodeï¼Œå¦‚æœmarkdownå‰é¢å†™äº†codeä¸ºtrueé‚£ä¹ˆå°±ä¼šå‡ºç°åæ–‡æ•°æ®ã€‚

<img class="lazy" data-src="/assets/content/astro/code.png">

+ é™æ€æ–‡ä»¶ä¸€èˆ¬æ”¾åœ¨pulbic é‡Œé¢ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨/xx/xx.cssæ¥è®¿é—®æ–‡ä»¶

## - - - æ¨ªçº¿å«ä¹‰

+ åœ¨Astroé‡Œé¢è¿™ä¸ªç±»ä¼¼ä¸nodeç¯å¢ƒï¼Œåœ¨markdowné‡Œé¢ï¼Œå¯ä»¥è®°ä½ä½œè€…ï¼Œæ—¶é—´ï¼Œæ ‡ç­¾ã€‚å¾ˆå¥½çš„åˆ†ç±»ï¼

## åˆ†ç±»æ–‡ä»¶æˆ‘ä»¬åº”è¯¥ä½¿ç”¨$å¼€å¤´çš„æ–‡ä»¶æ¥è¡¨ç¤ºåº”è¯¥åˆ†ç»„ã€‚

é›†åˆæ˜¯`src/pages`ç›®å½•ä¸­ä»¥ç¾å…ƒç¬¦å· ( `$`)å¼€å¤´å¹¶`createCollection`åœ¨ç»„ä»¶è„šæœ¬ä¸­åŒ…å«å¯¼å‡ºå‡½æ•°çš„ä»»ä½•æ–‡ä»¶ã€‚

æŸ¥çœ‹[Astro Collections](https://docs.astro.build/core-concepts/collections)æŒ‡å—ä»¥è·å–æ›´å¤šä¿¡æ¯å’Œç¤ºä¾‹ã€‚

### `createCollection()`

```jsx
---
export async function createCollection() {
  return { /* ... */ };
}
---
<!-- Your HTML template here. -->
```

âš ï¸ è¯¥`createCollection()`å‡½æ•°åœ¨é¡µé¢åŠ è½½ä¹‹å‰åœ¨å…¶è‡ªå·±çš„éš”ç¦»èŒƒå›´å†…æ‰§è¡Œã€‚å› æ­¤ï¼Œé™¤äº†æ–‡ä»¶å¯¼å…¥ä¹‹å¤–ï¼Œæ‚¨ä¸èƒ½ä»å…¶çˆ¶ä½œç”¨åŸŸä¸­å¼•ç”¨ä»»ä½•å†…å®¹ã€‚å¦‚æœæ‚¨è¿åæ­¤è¦æ±‚ï¼Œç¼–è¯‘å™¨å°†å‘å‡ºè­¦å‘Šã€‚

è¯¥`createCollection()`å‡½æ•°åº”è¿”å›ä»¥ä¸‹å½¢çŠ¶çš„å¯¹è±¡ï¼š

| åç§°       | ç±»å‹                                                         | æè¿°                                                         |
| :--------- | :----------------------------------------------------------- | :----------------------------------------------------------- |
| `route`    | `string`                                                     | **å¿…éœ€çš„ã€‚**ç”¨äºåŒ¹é… URL è¯·æ±‚çš„è·¯ç”±æ¨¡å¼ã€‚è¿™ç”¨äºåœ¨æœ€ç»ˆæ„å»ºä¸­ç”Ÿæˆé¡µé¢ URLã€‚å®ƒå¿…é¡»ä»¥æ–‡ä»¶åå¼€å¤´ï¼šä¾‹å¦‚ï¼Œ`pages/$tags.astro`å¿…é¡»è¿”å›`route`ä»¥`/tags/`. |
| `paths`    | `{params: Params}[]`                                         | è¿”å›è¦ç”Ÿæˆçš„æ‰€æœ‰ URL çš„æ•°ç»„ã€‚                                |
| `props`    | `async ({ params, paginate }) => object`                     | **å¿…éœ€çš„ã€‚**åŠ è½½å°†ä½œä¸ºé“å…·ä¼ é€’ç»™é¡µé¢ç»„ä»¶çš„é¡µé¢æ•°æ®ã€‚         |
| `paginate` | `boolean`                                                    | å¯é€‰ï¼šå¯ç”¨è‡ªåŠ¨åˆ†é¡µã€‚è§ä¸‹ä¸€èŠ‚ã€‚                               |

## exports interface Propså«ä¹‰

+ ä»£ç è§£é‡Š

```javascript
// <!-- åœ¨componentsé‡Œé¢ï¼Œæˆ‘ä»¬ä½¿ç”¨ -->
exports interface Props {
    title: string,
    code: Boolean
}
const {title, code} = Astro.props
/*
ç”¨è¿™ç§æ–¹æ³•æ¥æ¥å—ä»çˆ¶çº§æ¥çš„æ•°æ®ï¼Œç„¶åæ˜¯å“¦é‚£ä¸ªAstro.propsæ¥æ¥æ”¶ï¼
*/
```


## ä¸ä»…æ˜¯astroè¿˜å¯ä»¥ä½¿ç”¨å¤šç§å‰ç«¯æ¡†æ¶æ¥å½“ä½œç»„ä»¶(å¹¶ä¸”æ°´å’Œ)

+ astroçš„ä¼˜åŠ¿ä¸ä»…ä»…æ˜¯é™æ€ç«™ç‚¹é‚£ä¹ˆç®€å•ï¼Œè¿˜å¯ä»¥ä½¿ç”¨javascript æ¡†æ¶çš„ç»„ä»¶æ¥è¡¨ç¤ºæ•°æ®ã€‚è¿™å°±æ˜¯å®ƒçš„ä¼˜åŠ¿ï¼ï¼

```vue
<!-- åœ¨é¡µé¢åŠ è½½æ—¶æ°´å’Œ -->
<vueCount client:load/>
```

## cliå‘½ä»¤è¡Œ

### `--config path`

æŒ‡å®šé…ç½®æ–‡ä»¶çš„è·¯å¾„ã€‚é»˜è®¤ä¸º`astro.config.mjs`. å¦‚æœæ‚¨ä¸ºé…ç½®æ–‡ä»¶ä½¿ç”¨ä¸åŒçš„åç§°æˆ–å°†é…ç½®æ–‡ä»¶æ”¾åœ¨å¦ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­ï¼Œè¯·ä½¿ç”¨æ­¤é€‰é¡¹ã€‚

```shell
astro --config config/astro.config.mjs dev
```

### `--project-root path`

æŒ‡å®šé¡¹ç›®æ ¹ç›®å½•çš„è·¯å¾„ã€‚å¦‚æœæœªæŒ‡å®šï¼Œåˆ™å‡å®šå½“å‰å·¥ä½œç›®å½•æ˜¯æ ¹ç›®å½•ã€‚

æ ¹ç”¨äºæŸ¥æ‰¾ Astro é…ç½®æ–‡ä»¶ã€‚

```shell
astro --project-root examples/snowpack dev
```

### `--reload`

æ¸…é™¤ç¼“å­˜ï¼ˆä¾èµ–é¡¹åœ¨ Astro åº”ç”¨ç¨‹åºä¸­æ„å»ºï¼‰ã€‚

### `--verbose`

å¯ç”¨è¯¦ç»†æ—¥å¿—è®°å½•ï¼Œè¿™åœ¨è°ƒè¯•é—®é¢˜æ—¶å¾ˆæœ‰å¸®åŠ©ã€‚

### `--silent`

å¯ç”¨é™é»˜æ—¥å¿—è®°å½•ï¼Œè¿™åœ¨æ‚¨ä¸æƒ³çœ‹åˆ° Astro æ—¥å¿—æ—¶å¾ˆæœ‰å¸®åŠ©ã€‚

### `--version`

æ‰“å° Astro ç‰ˆæœ¬å·å¹¶é€€å‡ºã€‚

### `--help`

æ‰“å°å¸®åŠ©ä¿¡æ¯å¹¶é€€å‡ºã€‚


## bugğŸ›

+ ç›®å‰é‡åˆ°çš„bugï¼Œå°å¿ƒè¸©å‘ï¼

1. æ’æ§½é—®é¢˜ï¼Œå…·åæ’æ§½å‡ºç°é—®é¢˜(å…·åä¸å…·åç°è±¡) astroç‰ˆæœ¬è¦>0.18ã€‚ä¹‹å‰é—®é¢˜æ˜¯å®‰è£…äº†0.17çš„ç‰ˆæœ¬æ‰å‡ºç°çš„ã€‚

2. npm init astroå‡ºç°çš„é—®é¢˜ï¼Œ åˆ é™¤ç¼“å­˜ cç›˜ä¸‹é¢.degit/.github/astroé‡Œé¢çš„æ•°æ®


## ç»“å°¾

+ æˆ‘å†™çš„å¾ˆç®€é™‹ï¼Œæ ·å¼åŸºæœ¬ä¸Šæ²¡æ€ä¹ˆå†™ï¼Œastroæ–‡ä»¶é‡Œé¢çš„æ ·å¼å¯ä»¥åœ¨styleé‡Œé¢ä½¿ç”¨lang="scss"ï¼Œastroä¼šè‡ªåŠ¨æ¸²æŸ“è§£æscssçš„æ ·å¼ã€‚å½“ç„¶äº†æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨tailwindcss[^4]å‰ç«¯cssæ¡†æ¶ã€‚

+ astroæ–‡æ¡£è¿˜åœ¨æ›´æ–°ï¼Œé—®é¢˜ä¹Ÿæ˜¯å¾ˆå¤šã€‚æˆ‘ä¸æ˜¯æƒ³æˆä¸ºç¬¬ä¸€ä¸ªåƒèƒèŸ¹çš„äººï¼Œæˆ‘åªæ˜¯çƒ­çˆ±ï¼

***

[^1]: [Astroå®˜ç½‘](https://astro.build/)
[^2]: [Astroæ–‡æ¡£](https://docs.astro.build/getting-star)
[^3]: [Githubåœ°å€](https://github.com/snowpackjs/astro)
[^4]: [æ— éœ€ä¹¦å†™cssçš„å‰ç«¯cssæ¡†æ¶](https://www.tailwindcss.cn/)
